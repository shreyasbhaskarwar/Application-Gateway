(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{328:function(e,t,a){"use strict";a.r(t);var s=a(14),n=Object(s.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"key-management-and-jwt-signer"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#key-management-and-jwt-signer"}},[e._v("#")]),e._v(" Key management and JWT signer")]),e._v(" "),t("h2",{attrs:{id:"key-management-configuration"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#key-management-configuration"}},[e._v("#")]),e._v(" Key management configuration")]),e._v(" "),t("p",[e._v("This is a top level configuration element.")]),e._v(" "),t("div",{staticClass:"language-yaml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("keyManagementProfile")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("keyRotationProfile")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("type")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" defaultKeyRotation\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("useSigningKeyRotation")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token boolean important"}},[e._v("true")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("signingKeyRotationSeconds")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("28800")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("cleanupFrequencySeconds")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("10000")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("jwkStoreProfile")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("type")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" localRsaJwkStore\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("implSpecificSettings")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("exampleParameter")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"not used"')]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("keyGeneratorProfile")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("type")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" rsaKeyGenerator\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("keySize")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("4096")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("implSpecificSettings")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("exampleParameter")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"not used"')]),e._v("\n")])])]),t("p",[t("strong",[e._v("keyRotationProfile part")])]),e._v(" "),t("ul",[t("li",[t("code",[e._v("type")]),e._v(": Defines the key rotation strategy. Currently supported: 'defaultKeyRotation'.")]),e._v(" "),t("li",[t("code",[e._v("useSigningKeyRotation")]),e._v(": Set to true to automatically generate a new key from time to time (recommended). Set to false to only generate a key at startup.")]),e._v(" "),t("li",[t("code",[e._v("signingKeyRotationSeconds")]),e._v(": Rotate the signing key after that many seconds.")]),e._v(" "),t("li",[t("code",[e._v("cleanupFrequencySeconds")]),e._v(": Run memory clean-up of expired signing keys after that many seconds. (Note that signing keys have a grace period during which they are still served when requested anyway built-in.)")])]),e._v(" "),t("p",[t("strong",[e._v("jwkStoreProfile part")])]),e._v(" "),t("ul",[t("li",[t("code",[e._v("type")]),e._v(": Defines what type of keys the signing key store can hold. Currently supported: "),t("code",[e._v("localRsaJwkStore")]),e._v(".")]),e._v(" "),t("li",[t("code",[e._v("implSpecificSettings")]),e._v(": Key/value pairs required by the store implementation selected above. "),t("code",[e._v("localRsaJwkStore")]),e._v(" needs none.")])]),e._v(" "),t("p",[t("strong",[e._v("keyGeneratorProfile part")])]),e._v(" "),t("ul",[t("li",[t("code",[e._v("type")]),e._v(": The key generator to use. Currently supported: "),t("code",[e._v("rsaKeyGenerator")]),e._v(".")]),e._v(" "),t("li",[t("code",[e._v("keySize")]),e._v(": The number of bits for generated keys.")]),e._v(" "),t("li",[t("code",[e._v("implSpecificSettings")]),e._v(":  key generator impl specific settings. "),t("code",[e._v("rsaKeyGenerator")]),e._v(" requires no additional settings.")])]),e._v(" "),t("h3",{attrs:{id:"key-rotation-implementations"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#key-rotation-implementations"}},[e._v("#")]),e._v(" key rotation implementations")]),e._v(" "),t("h4",{attrs:{id:"defaultkeyrotation"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#defaultkeyrotation"}},[e._v("#")]),e._v(" "),t("code",[e._v("defaultKeyRotation")])]),e._v(" "),t("p",[e._v("Implements a key rotation scheme that uses the configured keyGenerator to generate new keys and make them available in the configured jwkStore.\nMakes sure that on startup a new signing key is generated.\nUpdates also the currentSigningKeyHolder with the new key. Heeds the standard configuration settings and does not require any "),t("code",[e._v("implSpecificSettings")]),e._v(".")]),e._v(" "),t("h3",{attrs:{id:"jwkstore-implementations"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jwkstore-implementations"}},[e._v("#")]),e._v(" jwkStore implementations")]),e._v(" "),t("h4",{attrs:{id:"localrsajwkstore"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#localrsajwkstore"}},[e._v("#")]),e._v(" "),t("code",[e._v("localRsaJwkStore")])]),e._v(" "),t("p",[e._v("Stores signing keys as long as they are valid (plus a grace time of 10 minutes) in memory and local only.\nDoes not require any "),t("code",[e._v("implSpecificSettings")]),e._v(".")]),e._v(" "),t("h3",{attrs:{id:"key-generator-implementations"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#key-generator-implementations"}},[e._v("#")]),e._v(" key generator implementations")]),e._v(" "),t("h4",{attrs:{id:"rsakeygenerator"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rsakeygenerator"}},[e._v("#")]),e._v(" "),t("code",[e._v("rsaKeyGenerator")])]),e._v(" "),t("p",[e._v("Generates RSA keys.\nDoes not require any "),t("code",[e._v("implSpecificSettings")]),e._v(".")]),e._v(" "),t("h2",{attrs:{id:"jwt-signer"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jwt-signer"}},[e._v("#")]),e._v(" Jwt signer")]),e._v(" "),t("p",[e._v("The key signer used for a JWT passed to downstream system is configured in the security profile assigned to a route and only available for 'jwt-mapping'.")]),e._v(" "),t("div",{staticClass:"language-yaml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("userMapping")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("type")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"jwt-mapping"')]),e._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("settings")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("...")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("signatureImplementation")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"rsa"')]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("signatureSettings")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n")])])]),t("p",[t("strong",[e._v("relevant settings part")])]),e._v(" "),t("ul",[t("li",[t("code",[e._v("signatureImplementation")]),e._v(": The signature implementation to use. Currently supported: "),t("code",[e._v("rsa")]),e._v(", "),t("code",[e._v("hmac")]),e._v(" (not recommended).")]),e._v(" "),t("li",[t("code",[e._v("signatureSettings")]),e._v(": signature implementation specific settings. "),t("code",[e._v("rsa")]),e._v(" requires none.")])]),e._v(" "),t("h3",{attrs:{id:"jwt-signers-signatureimplementation"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jwt-signers-signatureimplementation"}},[e._v("#")]),e._v(" jwt signers ("),t("code",[e._v("signatureImplementation")]),e._v(")")]),e._v(" "),t("h4",{attrs:{id:"rsa"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rsa"}},[e._v("#")]),e._v(" "),t("code",[e._v("rsa")])]),e._v(" "),t("p",[e._v("Implements RS256 JWT signature based on automatically generated (zero-config) keys as implemented by the key rotation configuration.\nAdds kid and jku headers to the JWT.\nDoes not need any configuration settings.")]),e._v(" "),t("h4",{attrs:{id:"hmac-not-recommended"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#hmac-not-recommended"}},[e._v("#")]),e._v(" "),t("code",[e._v("hmac")]),e._v(" (not recommended)")]),e._v(" "),t("p",[e._v("Implements HS256, HS385, HS512 (derived  from key size) JWT signatures.\nAdds kid header, but naturally no jku header to the JWT.\nRequires these "),t("code",[e._v("signatureSettings")]),e._v(":")]),e._v(" "),t("div",{staticClass:"language-yaml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("...")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("signatureSettings")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("keyId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"myKeyId"')]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("secretKey")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"546573744b6579546573744b6579546573744b6579546573744b657....9"')]),e._v("\n")])])]),t("p",[t("strong",[e._v("signatureSettings part")])]),e._v(" "),t("ul",[t("li",[t("code",[e._v("keyId")]),e._v(": The kid to be put in the JWT header.")]),e._v(" "),t("li",[t("code",[e._v("secretKey")]),e._v(": The hey encoded shared key used for signing the JWT. Depending on its length HS256 (for 256 bit key), HS348 or HS512 is automatically used.")])]),e._v(" "),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"custom-block-title"},[e._v("WARNING")]),e._v(" "),t("p",[e._v("Beware that the jwkStore, the keyGenerator as well as the jwtSigner used depend on each other! So if you use an RSA based JWT signer, you also need an RSA based jwkStore and keyGenerator. The keyRotation implementation is independent and relies on jwkStore and keyGenerator only.")])])])}),[],!1,null,null,null);t.default=n.exports}}]);